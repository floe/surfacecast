#!/bin/bash
DATA="<?xml version=\"1.0\"?><opencv_storage><cameraMatrix type_id=\"opencv-matrix\"><rows>3</rows><cols>3</cols><dt>f</dt><data>2.4822374984983458e+03 0. 9.2096110887416614e+02 0. 2.4720169449623145e+03 4.8401422669733853e+02 0. 0. 1.</data></cameraMatrix><distCoeffs type_id=\"opencv-matrix\"> <rows>5</rows><cols>1</cols><dt>f</dt><data>-5.6049386515526289e-01 9.0250527240305245e-01 -4.9116002521994563e-04 4.5750344234100324e-04 -1.7859587542463775e+00</data></distCoeffs></opencv_storage>"
# gst-launch-1.0 videotestsrc ! video/x-raw,width=1920,height=1080,format=I420,framerate=15/1 ! queue ! x264enc ! video/x-h264,profile=constrained-baseline,stream-format=byte-stream ! h264parse config-interval=-1 ! rtph264pay config-interval=1 ! application/x-rtp,media=video,encoding-name=H264,payload=96 ! udpsink host=spiderpi.lan port=3000
gst-launch-1.0 libcamerasrc ! video/x-raw,width=1920,height=1080,format=BGR,framerate=15/1 ! cameraundistort settings="$DATA" ! queue max-size-time=100000000 leaky=downstream ! videoconvert ! x264enc bitrate=6000 speed-preset=ultrafast tune=zerolatency key-int-max=15 ! video/x-h264,profile=constrained-baseline,stream-format=byte-stream ! queue ! h264parse config-interval=-1 ! rtph264pay config-interval=1 ! application/x-rtp,media=video,encoding-name=H264,payload=96 ! udpsink host=sliver.lan port=3000
